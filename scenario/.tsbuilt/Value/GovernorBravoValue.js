"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getGovernorBravoValue = exports.governorBravoFetchers = exports.getGovernorV = void 0;
const CoreValue_1 = require("../CoreValue");
const Value_1 = require("../Value");
const Command_1 = require("../Command");
const BravoProposalValue_1 = require("./BravoProposalValue");
const ContractLookup_1 = require("../ContractLookup");
async function getGovernorV(world, event) {
    const address = await CoreValue_1.mapValue(world, event, (str) => new Value_1.AddressV(ContractLookup_1.getGovernorAddress(world, str)), CoreValue_1.getCoreValue, Value_1.AddressV);
    return ContractLookup_1.getWorldContractByAddress(world, address.val);
}
exports.getGovernorV = getGovernorV;
async function governorAddress(world, governor) {
    return new Value_1.AddressV(governor._address);
}
async function getAdmin(world, governor) {
    return new Value_1.AddressV(await governor.methods.admin().call());
}
async function getPendingAdmin(world, governor) {
    return new Value_1.AddressV(await governor.methods.pendingAdmin().call());
}
async function getImplementation(world, governor) {
    return new Value_1.AddressV(await governor.methods.implementation().call());
}
async function getProposalThreshold(world, governor) {
    return new Value_1.NumberV(await governor.methods.proposalThreshold().call());
}
async function getVotingPeriod(world, governor) {
    return new Value_1.NumberV(await governor.methods.votingPeriod().call());
}
async function getVotingDelay(world, governor) {
    return new Value_1.NumberV(await governor.methods.votingDelay().call());
}
async function getIsWhitelisted(world, governor, account) {
    return new Value_1.BoolV(await governor.methods.isWhitelisted(account).call());
}
function governorBravoFetchers() {
    return [
        new Command_1.Fetcher(`
        #### Address

        * "GovernorBravo <GovernorBravo> Address" - Returns the address of governorBravo contract
        * E.g. "GovernorBravo GovernorBravoScenario Address"
      `, "Address", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => governorAddress(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Admin

        * "GovernorBravo <Governor> Admin" - Returns the address of governorBravo admin
        * E.g. "GovernorBravo GovernorBravoScenario Admin"
      `, "Admin", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getAdmin(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Pending Admin

        * "GovernorBravo <Governor> PendingAdmin" - Returns the address of governorBravo pending admin
        * E.g. "GovernorBravo GovernorBravoScenario PendingAdmin"
      `, "PendingAdmin", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getPendingAdmin(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Implementation

        * "GovernorBravo <Governor> Implementation" - Returns the address of governorBravo implementation
        * E.g. "GovernorBravo GovernorBravoScenario Implementation"
      `, "Implementation", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getImplementation(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### ProposalThreshold

        * "GovernorBravo <Governor> ProposalThreshold" - Returns the proposal threshold of the given governorBravo 
        * E.g. "GovernorBravo GovernorBravoScenario ProposalThreshold"
      `, "ProposalThreshold", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getProposalThreshold(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### VotingPeriod

        * "GovernorBravo <Governor> VotingPeriod" - Returns the voting period of the given governorBravo 
        * E.g. "GovernorBravo GovernorBravoScenario VotingPeriod"
      `, "VotingPeriod", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getVotingPeriod(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### VotingDelay

        * "GovernorBravo <Governor> VotingDelay" - Returns the voting delay of the given governorBravo 
        * E.g. "GovernorBravo GovernorBravoScenario VotingDelay"
      `, "VotingDelay", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getVotingDelay(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Proposal

        * "GovernorBravo <Governor> Proposal <...proposalValue>" - Returns information about a proposal
        * E.g. "GovernorBravo GovernorBravoScenario Proposal LastProposal Id"
      `, "Proposal", [
            new Command_1.Arg("governor", getGovernorV),
            new Command_1.Arg("params", CoreValue_1.getEventV, { variadic: true }),
        ], (world, { governor, params }) => BravoProposalValue_1.getProposalValue(world, governor, params.val), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### IsWhitelisted

        * "GovernorBravo <Governor> IsWhitelisted <Account>" - Returns the whitelist status for a given account
        * E.g. "GovernorBravo GovernorBravoScenario IsWhitelisted Jared"
      `, "IsWhitelisted", [new Command_1.Arg("governor", getGovernorV), new Command_1.Arg("account", CoreValue_1.getAddressV)], (world, { governor, account }) => getIsWhitelisted(world, governor, account.val), { namePos: 1 }),
    ];
}
exports.governorBravoFetchers = governorBravoFetchers;
async function getGovernorBravoValue(world, event) {
    return await Command_1.getFetcherValue("GovernorBravo", governorBravoFetchers(), world, event);
}
exports.getGovernorBravoValue = getGovernorBravoValue;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR292ZXJub3JCcmF2b1ZhbHVlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL1ZhbHVlL0dvdmVybm9yQnJhdm9WYWx1ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFHQSw0Q0FBOEU7QUFDOUUsb0NBQW1FO0FBQ25FLHdDQUEyRDtBQUMzRCw2REFBd0Q7QUFDeEQsc0RBRzJCO0FBRXBCLEtBQUssVUFBVSxZQUFZLENBQ2hDLEtBQVksRUFDWixLQUFZO0lBRVosTUFBTSxPQUFPLEdBQUcsTUFBTSxvQkFBUSxDQUM1QixLQUFLLEVBQ0wsS0FBSyxFQUNMLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxJQUFJLGdCQUFRLENBQUMsbUNBQWtCLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQ3JELHdCQUFZLEVBQ1osZ0JBQVEsQ0FDVCxDQUFDO0lBRUYsT0FBTywwQ0FBeUIsQ0FBZ0IsS0FBSyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUN0RSxDQUFDO0FBYkQsb0NBYUM7QUFFRCxLQUFLLFVBQVUsZUFBZSxDQUM1QixLQUFZLEVBQ1osUUFBdUI7SUFFdkIsT0FBTyxJQUFJLGdCQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3pDLENBQUM7QUFFRCxLQUFLLFVBQVUsUUFBUSxDQUNyQixLQUFZLEVBQ1osUUFBdUI7SUFFdkIsT0FBTyxJQUFJLGdCQUFRLENBQUMsTUFBTSxRQUFRLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7QUFDN0QsQ0FBQztBQUVELEtBQUssVUFBVSxlQUFlLENBQzVCLEtBQVksRUFDWixRQUF1QjtJQUV2QixPQUFPLElBQUksZ0JBQVEsQ0FBQyxNQUFNLFFBQVEsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUNwRSxDQUFDO0FBRUQsS0FBSyxVQUFVLGlCQUFpQixD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LENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQ2hELEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxDQUNmO0tBQ0YsQ0FBQztBQUNKLENBQUM7QUE1SEQsc0RBNEhDO0FBRU0sS0FBSyxVQUFVLHFCQUFxQixDQUN6QyxLQUFZLEVBQ1osS0FBWTtJQUVaLE9BQU8sTUFBTSx5QkFBZSxDQUMxQixlQUFlLEVBQ2YscUJBQXFCLEVBQUUsRUFDdkIsS0FBSyxFQUNMLEtBQUssQ0FDTixDQUFDO0FBQ0osQ0FBQztBQVZELHNEQVVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXZlbnQgfSBmcm9tIFwiLi4vRXZlbnRcIjtcbmltcG9ydCB7IFdvcmxkIH0gZnJvbSBcIi4uL1dvcmxkXCI7XG5pbXBvcnQgeyBHb3Zlcm5vckJyYXZvIH0gZnJvbSBcIi4uL0NvbnRyYWN0L0dvdmVybm9yQnJhdm9cIjtcbmltcG9ydCB7IGdldENvcmVWYWx1ZSwgZ2V0RXZlbnRWLCBtYXBWYWx1ZSwgZ2V0QWRkcmVzc1YgfSBmcm9tIFwiLi4vQ29yZVZhbHVlXCI7XG5pbXBvcnQgeyBBZGRyZXNzViwgTnVtYmVyViwgRXZlbnRWLCBWYWx1ZSwgQm9vbFYgfSBmcm9tIFwiLi4vVmFsdWVcIjtcbmltcG9ydCB7IEFyZywgRmV0Y2hlciwgZ2V0RmV0Y2hlclZhbHVlIH0gZnJvbSBcIi4uL0NvbW1hbmRcIjtcbmltcG9ydCB7IGdldFByb3Bvc2FsVmFsdWUgfSBmcm9tIFwiLi9CcmF2b1Byb3Bvc2FsVmFsdWVcIjtcbmltcG9ydCB7XG4gIGdldEdvdmVybm9yQWRkcmVzcyxcbiAgZ2V0V29ybGRDb250cmFjdEJ5QWRkcmVzcyxcbn0gZnJvbSBcIi4uL0NvbnRyYWN0TG9va3VwXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHb3Zlcm5vclYoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZXZlbnQ6IEV2ZW50XG4pOiBQcm9taXNlPEdvdmVybm9yQnJhdm8+IHtcbiAgY29uc3QgYWRkcmVzcyA9IGF3YWl0IG1hcFZhbHVlPEFkZHJlc3NWPihcbiAgICB3b3JsZCxcbiAgICBldmVudCxcbiAgICAoc3RyKSA9PiBuZXcgQWRkcmVzc1YoZ2V0R292ZXJub3JBZGRyZXNzKHdvcmxkLCBzdHIpKSxcbiAgICBnZXRDb3JlVmFsdWUsXG4gICAgQWRkcmVzc1ZcbiAgKTtcblxuICByZXR1cm4gZ2V0V29ybGRDb250cmFjdEJ5QWRkcmVzczxHb3Zlcm5vckJyYXZvPih3b3JsZCwgYWRkcmVzcy52YWwpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBnb3Zlcm5vckFkZHJlc3MoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZ292ZXJub3I6IEdvdmVybm9yQnJhdm9cbik6IFByb21pc2U8QWRkcmVzc1Y+IHtcbiAgcmV0dXJuIG5ldyBBZGRyZXNzVihnb3Zlcm5vci5fYWRkcmVzcyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEFkbWluKFxuICB3b3JsZDogV29ybGQsXG4gIGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvXG4pOiBQcm9taXNlPEFkZHJlc3NWPiB7XG4gIHJldHVybiBuZXcgQWRkcmVzc1YoYXdhaXQgZ292ZXJub3IubWV0aG9kcy5hZG1pbigpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFBlbmRpbmdBZG1pbihcbiAgd29ybGQ6IFdvcmxkLFxuICBnb3Zlcm5vcjogR292ZXJub3JCcmF2b1xuKTogUHJvbWlzZTxBZGRyZXNzVj4ge1xuICByZXR1cm4gbmV3IEFkZHJlc3NWKGF3YWl0IGdvdmVybm9yLm1ldGhvZHMucGVuZGluZ0FkbWluKCkuY2FsbCgpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0SW1wbGVtZW50YXRpb24oXG4gIHdvcmxkOiBXb3JsZCxcbiAgZ292ZXJub3I6IEdvdmVybm9yQnJhdm9cbik6IFByb21pc2U8QWRkcmVzc1Y+IHtcbiAgcmV0dXJuIG5ldyBBZGRyZXNzVihhd2FpdCBnb3Zlcm5vci5tZXRob2RzLmltcGxlbWVudGF0aW9uKCkuY2FsbCgpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0UHJvcG9zYWxUaHJlc2hvbGQoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZ292ZXJub3I6IEdvdmVybm9yQnJhdm9cbik6IFByb21pc2U8TnVtYmVyVj4ge1xuICByZXR1cm4gbmV3IE51bWJlclYoYXdhaXQgZ292ZXJub3IubWV0aG9kcy5wcm9wb3NhbFRocmVzaG9sZCgpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFZvdGluZ1BlcmlvZChcbiAgd29ybGQ6IFdvcmxkLFxuICBnb3Zlcm5vcjogR292ZXJub3JCcmF2b1xuKTogUHJvbWlzZTxOdW1iZXJWPiB7XG4gIHJldHVybiBuZXcgTnVtYmVyVihhd2FpdCBnb3Zlcm5vci5tZXRob2RzLnZvdGluZ1BlcmlvZCgpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFZvdGluZ0RlbGF5KFxuICB3b3JsZDogV29ybGQsXG4gIGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvXG4pOiBQcm9taXNlPE51bWJlclY+IHtcbiAgcmV0dXJuIG5ldyBOdW1iZXJWKGF3YWl0IGdvdmVybm9yLm1ldGhvZHMudm90aW5nRGVsYXkoKS5jYWxsKCkpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRJc1doaXRlbGlzdGVkKFxuICB3b3JsZDogV29ybGQsXG4gIGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvLFxuICBhY2NvdW50OiBzdHJpbmdcbik6IFByb21pc2U8Qm9vbFY+IHtcbiAgcmV0dXJuIG5ldyBCb29sVihhd2FpdCBnb3Zlcm5vci5tZXRob2RzLmlzV2hpdGVsaXN0ZWQoYWNjb3VudCkuY2FsbCgpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdvdmVybm9yQnJhdm9GZXRjaGVycygpIHtcbiAgcmV0dXJuIFtcbiAgICBuZXcgRmV0Y2hlcjx7IGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvIH0sIEFkZHJlc3NWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBBZGRyZXNzXG5cbiAgICAgICAgKiBcIkdvdmVybm9yQnJhdm8gPEdvdmVybm9yQnJhdm8+IEFkZHJlc3NcIiAtIFJldHVybnMgdGhlIGFkZHJlc3Mgb2YgZ292ZXJub3JCcmF2byBjb250cmFjdFxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBBZGRyZXNzXCJcbiAgICAgIGAsXG4gICAgICBcIkFkZHJlc3NcIixcbiAgICAgIFtuZXcgQXJnKFwiZ292ZXJub3JcIiwgZ2V0R292ZXJub3JWKV0sXG4gICAgICAod29ybGQsIHsgZ292ZXJub3IgfSkgPT4gZ292ZXJub3JBZGRyZXNzKHdvcmxkLCBnb3Zlcm5vciksXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgRmV0Y2hlcjx7IGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvIH0sIEFkZHJlc3NWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBBZG1pblxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gQWRtaW5cIiAtIFJldHVybnMgdGhlIGFkZHJlc3Mgb2YgZ292ZXJub3JCcmF2byBhZG1pblxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBBZG1pblwiXG4gICAgICBgLFxuICAgICAgXCJBZG1pblwiLFxuICAgICAgW25ldyBBcmcoXCJnb3Zlcm5vclwiLCBnZXRHb3Zlcm5vclYpXSxcbiAgICAgICh3b3JsZCwgeyBnb3Zlcm5vciB9KSA9PiBnZXRBZG1pbih3b3JsZCwgZ292ZXJub3IpLFxuICAgICAgeyBuYW1lUG9zOiAxIH1cbiAgICApLFxuXG4gICAgbmV3IEZldGNoZXI8eyBnb3Zlcm5vcjogR292ZXJub3JCcmF2byB9LCBBZGRyZXNzVj4oXG4gICAgICBgXG4gICAgICAgICMjIyMgUGVuZGluZyBBZG1pblxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gUGVuZGluZ0FkbWluXCIgLSBSZXR1cm5zIHRoZSBhZGRyZXNzIG9mIGdvdmVybm9yQnJhdm8gcGVuZGluZyBhZG1pblxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBQZW5kaW5nQWRtaW5cIlxuICAgICAgYCxcbiAgICAgIFwiUGVuZGluZ0FkbWluXCIsXG4gICAgICBbbmV3IEFyZyhcImdvdmVybm9yXCIsIGdldEdvdmVybm9yVildLFxuICAgICAgKHdvcmxkLCB7IGdvdmVybm9yIH0pID0+IGdldFBlbmRpbmdBZG1pbih3b3JsZCwgZ292ZXJub3IpLFxuICAgICAgeyBuYW1lUG9zOiAxIH1cbiAgICApLFxuXG4gICAgbmV3IEZldGNoZXI8eyBnb3Zlcm5vcjogR292ZXJub3JCcmF2byB9LCBBZGRyZXNzVj4oXG4gICAgICBgXG4gICAgICAgICMjIyMgSW1wbGVtZW50YXRpb25cblxuICAgICAgICAqIFwiR292ZXJub3JCcmF2byA8R292ZXJub3I+IEltcGxlbWVudGF0aW9uXCIgLSBSZXR1cm5zIHRoZSBhZGRyZXNzIG9mIGdvdmVybm9yQnJhdm8gaW1wbGVtZW50YXRpb25cbiAgICAgICAgKiBFLmcuIFwiR292ZXJub3JCcmF2byBHb3Zlcm5vckJyYXZvU2NlbmFyaW8gSW1wbGVtZW50YXRpb25cIlxuICAgICAgYCxcbiAgICAgIFwiSW1wbGVtZW50YXRpb25cIixcbiAgICAgIFtuZXcgQXJnKFwiZ292ZXJub3JcIiwgZ2V0R292ZXJub3JWKV0sXG4gICAgICAod29ybGQsIHsgZ292ZXJub3IgfSkgPT4gZ2V0SW1wbGVtZW50YXRpb24od29ybGQsIGdvdmVybm9yKSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBGZXRjaGVyPHsgZ292ZXJub3I6IEdvdmVybm9yQnJhdm8gfSwgTnVtYmVyVj4oXG4gICAgICBgXG4gICAgICAgICMjIyMgUHJvcG9zYWxUaHJlc2hvbGRcblxuICAgICAgICAqIFwiR292ZXJub3JCcmF2byA8R292ZXJub3I+IFByb3Bvc2FsVGhyZXNob2xkXCIgLSBSZXR1cm5zIHRoZSBwcm9wb3NhbCB0aHJlc2hvbGQgb2YgdGhlIGdpdmVuIGdvdmVybm9yQnJhdm8gXG4gICAgICAgICogRS5nLiBcIkdvdmVybm9yQnJhdm8gR292ZXJub3JCcmF2b1NjZW5hcmlvIFByb3Bvc2FsVGhyZXNob2xkXCJcbiAgICAgIGAsXG4gICAgICBcIlByb3Bvc2FsVGhyZXNob2xkXCIsXG4gICAgICBbbmV3IEFyZyhcImdvdmVybm9yXCIsIGdldEdvdmVybm9yVildLFxuICAgICAgKHdvcmxkLCB7IGdvdmVybm9yIH0pID0+IGdldFByb3Bvc2FsVGhyZXNob2xkKHdvcmxkLCBnb3Zlcm5vciksXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgRmV0Y2hlcjx7IGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvIH0sIE51bWJlclY+KFxuICAgICAgYFxuICAgICAgICAjIyMjIFZvdGluZ1BlcmlvZFxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gVm90aW5nUGVyaW9kXCIgLSBSZXR1cm5zIHRoZSB2b3RpbmcgcGVyaW9kIG9mIHRoZSBnaXZlbiBnb3Zlcm5vckJyYXZvIFxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBWb3RpbmdQZXJpb2RcIlxuICAgICAgYCxcbiAgICAgIFwiVm90aW5nUGVyaW9kXCIsXG4gICAgICBbbmV3IEFyZyhcImdvdmVybm9yXCIsIGdldEdvdmVybm9yVildLFxuICAgICAgKHdvcmxkLCB7IGdvdmVybm9yIH0pID0+IGdldFZvdGluZ1BlcmlvZCh3b3JsZCwgZ292ZXJub3IpLFxuICAgICAgeyBuYW1lUG9zOiAxIH1cbiAgICApLFxuXG4gICAgbmV3IEZldGNoZXI8eyBnb3Zlcm5vcjogR292ZXJub3JCcmF2byB9LCBOdW1iZXJWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBWb3RpbmdEZWxheVxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gVm90aW5nRGVsYXlcIiAtIFJldHVybnMgdGhlIHZvdGluZyBkZWxheSBvZiB0aGUgZ2l2ZW4gZ292ZXJub3JCcmF2byBcbiAgICAgICAgKiBFLmcuIFwiR292ZXJub3JCcmF2byBHb3Zlcm5vckJyYXZvU2NlbmFyaW8gVm90aW5nRGVsYXlcIlxuICAgICAgYCxcbiAgICAgIFwiVm90aW5nRGVsYXlcIixcbiAgICAgIFtuZXcgQXJnKFwiZ292ZXJub3JcIiwgZ2V0R292ZXJub3JWKV0sXG4gICAgICAod29ybGQsIHsgZ292ZXJub3IgfSkgPT4gZ2V0Vm90aW5nRGVsYXkod29ybGQsIGdvdmVybm9yKSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBGZXRjaGVyPHsgZ292ZXJub3I6IEdvdmVybm9yQnJhdm87IHBhcmFtczogRXZlbnRWIH0sIFZhbHVlPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBQcm9wb3NhbFxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gUHJvcG9zYWwgPC4uLnByb3Bvc2FsVmFsdWU+XCIgLSBSZXR1cm5zIGluZm9ybWF0aW9uIGFib3V0IGEgcHJvcG9zYWxcbiAgICAgICAgKiBFLmcuIFwiR292ZXJub3JCcmF2byBHb3Zlcm5vckJyYXZvU2NlbmFyaW8gUHJvcG9zYWwgTGFzdFByb3Bvc2FsIElkXCJcbiAgICAgIGAsXG4gICAgICBcIlByb3Bvc2FsXCIsXG4gICAgICBbXG4gICAgICAgIG5ldyBBcmcoXCJnb3Zlcm5vclwiLCBnZXRHb3Zlcm5vclYpLFxuICAgICAgICBuZXcgQXJnKFwicGFyYW1zXCIsIGdldEV2ZW50ViwgeyB2YXJpYWRpYzogdHJ1ZSB9KSxcbiAgICAgIF0sXG4gICAgICAod29ybGQsIHsgZ292ZXJub3IsIHBhcmFtcyB9KSA9PlxuICAgICAgICBnZXRQcm9wb3NhbFZhbHVlKHdvcmxkLCBnb3Zlcm5vciwgcGFyYW1zLnZhbCksXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgRmV0Y2hlcjx7IGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvOyBhY2NvdW50OiBBZGRyZXNzViB9LCBCb29sVj4oXG4gICAgICBgXG4gICAgICAgICMjIyMgSXNXaGl0ZWxpc3RlZFxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gSXNXaGl0ZWxpc3RlZCA8QWNjb3VudD5cIiAtIFJldHVybnMgdGhlIHdoaXRlbGlzdCBzdGF0dXMgZm9yIGEgZ2l2ZW4gYWNjb3VudFxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBJc1doaXRlbGlzdGVkIEphcmVkXCJcbiAgICAgIGAsXG4gICAgICBcIklzV2hpdGVsaXN0ZWRcIixcbiAgICAgIFtuZXcgQXJnKFwiZ292ZXJub3JcIiwgZ2V0R292ZXJub3JWKSwgbmV3IEFyZyhcImFjY291bnRcIiwgZ2V0QWRkcmVzc1YpXSxcbiAgICAgICh3b3JsZCwgeyBnb3Zlcm5vciwgYWNjb3VudCB9KSA9PlxuICAgICAgICBnZXRJc1doaXRlbGlzdGVkKHdvcmxkLCBnb3Zlcm5vciwgYWNjb3VudC52YWwpLFxuICAgICAgeyBuYW1lUG9zOiAxIH1cbiAgICApLFxuICBdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0R292ZXJub3JCcmF2b1ZhbHVlKFxuICB3b3JsZDogV29ybGQsXG4gIGV2ZW50OiBFdmVudFxuKTogUHJvbWlzZTxWYWx1ZT4ge1xuICByZXR1cm4gYXdhaXQgZ2V0RmV0Y2hlclZhbHVlPGFueSwgYW55PihcbiAgICBcIkdvdmVybm9yQnJhdm9cIixcbiAgICBnb3Zlcm5vckJyYXZvRmV0Y2hlcnMoKSxcbiAgICB3b3JsZCxcbiAgICBldmVudFxuICApO1xufVxuIl19