"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTimelockValue = exports.timelockFetchers = exports.getTimelockAddress = void 0;
const CoreValue_1 = require("../CoreValue");
const Value_1 = require("../Value");
const Command_1 = require("../Command");
const ContractLookup_1 = require("../ContractLookup");
const Utils_1 = require("../Utils");
async function getTimelockAddress(world, timelock) {
    return new Value_1.AddressV(timelock._address);
}
exports.getTimelockAddress = getTimelockAddress;
async function getAdmin(world, timelock) {
    return new Value_1.AddressV(await timelock.methods.admin().call());
}
async function getPendingAdmin(world, timelock) {
    return new Value_1.AddressV(await timelock.methods.pendingAdmin().call());
}
async function getDelay(world, timelock) {
    return new Value_1.NumberV(await timelock.methods.delay().call());
}
async function queuedTransaction(world, timelock, txHash) {
    return new Value_1.BoolV(await timelock.methods.queuedTransactions(txHash).call());
}
function timelockFetchers() {
    return [
        new Command_1.Fetcher(`
        #### Address

        * "Address" - Gets the address of the Timelock
      `, 'Address', [new Command_1.Arg('timelock', ContractLookup_1.getTimelock, { implicit: true })], (world, { timelock }) => getTimelockAddress(world, timelock)),
        new Command_1.Fetcher(`
        #### Admin

        * "Admin" - Gets the address of the Timelock admin
      `, 'Admin', [new Command_1.Arg('timelock', ContractLookup_1.getTimelock, { implicit: true })], (world, { timelock }) => getAdmin(world, timelock)),
        new Command_1.Fetcher(`
        #### PendingAdmin

        * "PendingAdmin" - Gets the address of the Timelock pendingAdmin
      `, 'PendingAdmin', [new Command_1.Arg('timelock', ContractLookup_1.getTimelock, { implicit: true })], (world, { timelock }) => getPendingAdmin(world, timelock)),
        new Command_1.Fetcher(`
        #### Delay

        * "Delay" - Gets the delay of the Timelock
      `, 'Delay', [new Command_1.Arg('timelock', ContractLookup_1.getTimelock, { implicit: true })], (world, { timelock }) => getDelay(world, timelock)),
        new Command_1.Fetcher(`
        #### TxHash

        * "TxHash target:<Address> value:<Number> eta:<Number> signature:<String> ...funArgs:<CoreValue>" - Returns a hash of a transactions values
        * E.g. "Timelock TxHash \"0x0000000000000000000000000000000000000000\" 0 1569286014 \"setDelay(uint256)\" 60680"
      `, 'TxHash', [
            new Command_1.Arg('target', CoreValue_1.getAddressV),
            new Command_1.Arg('value', CoreValue_1.getNumberV),
            new Command_1.Arg('eta', CoreValue_1.getNumberV),
            new Command_1.Arg('signature', CoreValue_1.getStringV),
            new Command_1.Arg('data', CoreValue_1.getCoreValue, { variadic: true, mapped: true })
        ], (world, { target, value, signature, data, eta }) => {
            const encodedData = Utils_1.encodeParameters(world, signature.val, data.map(a => a.val));
            const encodedTransaction = world.web3.eth.abi.encodeParameters(['address', 'uint256', 'string', 'bytes', 'uint256'], [target.val, value.val, signature.val, encodedData, eta.val]);
            return Promise.resolve(new Value_1.StringV(world.web3.utils.keccak256(encodedTransaction)));
        }),
        new Command_1.Fetcher(`
        #### QueuedTransaction

        * "QueuedTransaction txHash:<String>" - Gets the boolean value of the given txHash in the queuedTransactions mapping
      `, 'QueuedTransaction', [new Command_1.Arg('timelock', ContractLookup_1.getTimelock, { implicit: true }), new Command_1.Arg('txHash', CoreValue_1.getStringV)], (world, { timelock, txHash }) => queuedTransaction(world, timelock, txHash.val))
    ];
}
exports.timelockFetchers = timelockFetchers;
async function getTimelockValue(world, event) {
    return await Command_1.getFetcherValue('Timelock', timelockFetchers(), world, event);
}
exports.getTimelockValue = getTimelockValue;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGltZWxvY2tWYWx1ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9WYWx1ZS9UaW1lbG9ja1ZhbHVlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUdBLDRDQUFpRjtBQUNqRixvQ0FBb0U7QUFDcEUsd0NBQTJEO0FBQzNELHNEQUFnRDtBQUNoRCxvQ0FBNEM7QUFFckMsS0FBSyxVQUFVLGtCQUFrQixDQUFDLEtBQVksRUFBRSxRQUFrQjtJQUN2RSxPQUFPLElBQUksZ0JBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDekMsQ0FBQztBQUZELGdEQUVDO0FBRUQsS0FBSyxVQUFVLFFBQVEsQ0FBQyxLQUFZLEVBQUUsUUFBa0I7SUFDdEQsT0FBTyxJQUFJLGdCQUFRLENBQUMsTUFBTSxRQUFRLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7QUFDN0QsQ0FBQztBQUVELEtBQUssVUFBVSxlQUFlLENBQUMsS0FBWSxFQUFFLFFBQWtCO0lBQzdELE9BQU8sSUFBSSxnQkFBUSxDQUFDLE1BQU0sUUFBUSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQ3BFLENBQUM7QUFFRCxLQUFLLFVBQVUsUUFBUSxDQUFDLEtBQVksRUFBRSxRQUFrQjtJQUN0RCxPQUFPLElBQUksZUFBTyxDQUFDLE1BQU0sUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQzVELENBQUM7QUFFRCxLQUFLLFVBQVUsaUJBQWlCLENBQUMsS0FBWSxFQUFFLFFBQWtCLEVBQUUsTUFBYztJQUMvRSxPQUFPLElBQUksYUFBSyxDQUFDLE1BQU0sUUFBUSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQzdFLENBQUM7QUFFRCxTQUFnQixn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QUksYUFBRyxDQUFDLFVBQVUsRUFBRSw0QkFBVyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsSUFBSSxhQUFHLENBQUMsUUFBUSxFQUFFLHNCQUFVLENBQUMsQ0FBQyxFQUNyRixDQUFDLEtBQUssRUFBRSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQ2hGO0tBQ0YsQ0FBQztBQUNKLENBQUM7QUF2RkQsNENBdUZDO0FBRU0sS0FBSyxVQUFVLGdCQUFnQixDQUFDLEtBQVksRUFBRSxLQUFZO0lBQy9ELE9BQU8sTUFBTSx5QkFBZSxDQUFXLFVBQVUsRUFBRSxnQkFBZ0IsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztBQUN2RixDQUFDO0FBRkQsNENBRUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudCB9IGZyb20gJy4uL0V2ZW50JztcbmltcG9ydCB7IFdvcmxkIH0gZnJvbSAnLi4vV29ybGQnO1xuaW1wb3J0IHsgVGltZWxvY2sgfSBmcm9tICcuLi9Db250cmFjdC9UaW1lbG9jayc7XG5pbXBvcnQgeyBnZXRBZGRyZXNzViwgZ2V0Q29yZVZhbHVlLCBnZXROdW1iZXJWLCBnZXRTdHJpbmdWIH0gZnJvbSAnLi4vQ29yZVZhbHVlJztcbmltcG9ydCB7IEFkZHJlc3NWLCBCb29sViwgTnVtYmVyViwgU3RyaW5nViwgVmFsdWUgfSBmcm9tICcuLi9WYWx1ZSc7XG5pbXBvcnQgeyBBcmcsIEZldGNoZXIsIGdldEZldGNoZXJWYWx1ZSB9IGZyb20gJy4uL0NvbW1hbmQnO1xuaW1wb3J0IHsgZ2V0VGltZWxvY2sgfSBmcm9tICcuLi9Db250cmFjdExvb2t1cCc7XG5pbXBvcnQgeyBlbmNvZGVQYXJhbWV0ZXJzIH0gZnJvbSAnLi4vVXRpbHMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VGltZWxvY2tBZGRyZXNzKHdvcmxkOiBXb3JsZCwgdGltZWxvY2s6IFRpbWVsb2NrKTogUHJvbWlzZTxBZGRyZXNzVj4ge1xuICByZXR1cm4gbmV3IEFkZHJlc3NWKHRpbWVsb2NrLl9hZGRyZXNzKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0QWRtaW4od29ybGQ6IFdvcmxkLCB0aW1lbG9jazogVGltZWxvY2spOiBQcm9taXNlPEFkZHJlc3NWPiB7XG4gIHJldHVybiBuZXcgQWRkcmVzc1YoYXdhaXQgdGltZWxvY2subWV0aG9kcy5hZG1pbigpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFBlbmRpbmdBZG1pbih3b3JsZDogV29ybGQsIHRpbWVsb2NrOiBUaW1lbG9jayk6IFByb21pc2U8QWRkcmVzc1Y+IHtcbiAgcmV0dXJuIG5ldyBBZGRyZXNzVihhd2FpdCB0aW1lbG9jay5tZXRob2RzLnBlbmRpbmdBZG1pbigpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldERlbGF5KHdvcmxkOiBXb3JsZCwgdGltZWxvY2s6IFRpbWVsb2NrKTogUHJvbWlzZTxOdW1iZXJWPiB7XG4gIHJldHVybiBuZXcgTnVtYmVyVihhd2FpdCB0aW1lbG9jay5tZXRob2RzLmRlbGF5KCkuY2FsbCgpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcXVldWVkVHJhbnNhY3Rpb24od29ybGQ6IFdvcmxkLCB0aW1lbG9jazogVGltZWxvY2ssIHR4SGFzaDogc3RyaW5nKTogUHJvbWlzZTxCb29sVj4ge1xuICByZXR1cm4gbmV3IEJvb2xWKGF3YWl0IHRpbWVsb2NrLm1ldGhvZHMucXVldWVkVHJhbnNhY3Rpb25zKHR4SGFzaCkuY2FsbCgpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRpbWVsb2NrRmV0Y2hlcnMoKSB7XG4gIHJldHVybiBbXG4gICAgbmV3IEZldGNoZXI8eyB0aW1lbG9jazogVGltZWxvY2sgfSwgQWRkcmVzc1Y+KFxuICAgICAgYFxuICAgICAgICAjIyMjIEFkZHJlc3NcblxuICAgICAgICAqIFwiQWRkcmVzc1wiIC0gR2V0cyB0aGUgYWRkcmVzcyBvZiB0aGUgVGltZWxvY2tcbiAgICAgIGAsXG4gICAgICAnQWRkcmVzcycsXG4gICAgICBbbmV3IEFyZygndGltZWxvY2snLCBnZXRUaW1lbG9jaywgeyBpbXBsaWNpdDogdHJ1ZSB9KV0sXG4gICAgICAod29ybGQsIHsgdGltZWxvY2sgfSkgPT4gZ2V0VGltZWxvY2tBZGRyZXNzKHdvcmxkLCB0aW1lbG9jaylcbiAgICApLFxuICAgIG5ldyBGZXRjaGVyPHsgdGltZWxvY2s6IFRpbWVsb2NrIH0sIEFkZHJlc3NWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBBZG1pblxuXG4gICAgICAgICogXCJBZG1pblwiIC0gR2V0cyB0aGUgYWRkcmVzcyBvZiB0aGUgVGltZWxvY2sgYWRtaW5cbiAgICAgIGAsXG4gICAgICAnQWRtaW4nLFxuICAgICAgW25ldyBBcmcoJ3RpbWVsb2NrJywgZ2V0VGltZWxvY2ssIHsgaW1wbGljaXQ6IHRydWUgfSldLFxuICAgICAgKHdvcmxkLCB7IHRpbWVsb2NrIH0pID0+IGdldEFkbWluKHdvcmxkLCB0aW1lbG9jaylcbiAgICApLFxuICAgIG5ldyBGZXRjaGVyPHsgdGltZWxvY2s6IFRpbWVsb2NrIH0sIEFkZHJlc3NWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBQZW5kaW5nQWRtaW5cblxuICAgICAgICAqIFwiUGVuZGluZ0FkbWluXCIgLSBHZXRzIHRoZSBhZGRyZXNzIG9mIHRoZSBUaW1lbG9jayBwZW5kaW5nQWRtaW5cbiAgICAgIGAsXG4gICAgICAnUGVuZGluZ0FkbWluJyxcbiAgICAgIFtuZXcgQXJnKCd0aW1lbG9jaycsIGdldFRpbWVsb2NrLCB7IGltcGxpY2l0OiB0cnVlIH0pXSxcbiAgICAgICh3b3JsZCwgeyB0aW1lbG9jayB9KSA9PiBnZXRQZW5kaW5nQWRtaW4od29ybGQsIHRpbWVsb2NrKVxuICAgICksXG4gICAgbmV3IEZldGNoZXI8eyB0aW1lbG9jazogVGltZWxvY2sgfSwgTnVtYmVyVj4oXG4gICAgICBgXG4gICAgICAgICMjIyMgRGVsYXlcblxuICAgICAgICAqIFwiRGVsYXlcIiAtIEdldHMgdGhlIGRlbGF5IG9mIHRoZSBUaW1lbG9ja1xuICAgICAgYCxcbiAgICAgICdEZWxheScsXG4gICAgICBbbmV3IEFyZygndGltZWxvY2snLCBnZXRUaW1lbG9jaywgeyBpbXBsaWNpdDogdHJ1ZSB9KV0sXG4gICAgICAod29ybGQsIHsgdGltZWxvY2sgfSkgPT4gZ2V0RGVsYXkod29ybGQsIHRpbWVsb2NrKVxuICAgICksXG4gICAgbmV3IEZldGNoZXI8XG4gICAgICB7XG4gICAgICAgIHRhcmdldDogQWRkcmVzc1Y7XG4gICAgICAgIHZhbHVlOiBOdW1iZXJWO1xuICAgICAgICBldGE6IE51bWJlclY7XG4gICAgICAgIHNpZ25hdHVyZTogU3RyaW5nVjtcbiAgICAgICAgZGF0YTogU3RyaW5nVltdO1xuICAgICAgfSxcbiAgICAgIFN0cmluZ1ZcbiAgICA+KFxuICAgICAgYFxuICAgICAgICAjIyMjIFR4SGFzaFxuXG4gICAgICAgICogXCJUeEhhc2ggdGFyZ2V0OjxBZGRyZXNzPiB2YWx1ZTo8TnVtYmVyPiBldGE6PE51bWJlcj4gc2lnbmF0dXJlOjxTdHJpbmc+IC4uLmZ1bkFyZ3M6PENvcmVWYWx1ZT5cIiAtIFJldHVybnMgYSBoYXNoIG9mIGEgdHJhbnNhY3Rpb25zIHZhbHVlc1xuICAgICAgICAqIEUuZy4gXCJUaW1lbG9jayBUeEhhc2ggXFxcIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMFxcXCIgMCAxNTY5Mjg2MDE0IFxcXCJzZXREZWxheSh1aW50MjU2KVxcXCIgNjA2ODBcIlxuICAgICAgYCxcbiAgICAgICdUeEhhc2gnLFxuICAgICAgW1xuICAgICAgICBuZXcgQXJnKCd0YXJnZXQnLCBnZXRBZGRyZXNzViksXG4gICAgICAgIG5ldyBBcmcoJ3ZhbHVlJywgZ2V0TnVtYmVyViksXG4gICAgICAgIG5ldyBBcmcoJ2V0YScsIGdldE51bWJlclYpLFxuICAgICAgICBuZXcgQXJnKCdzaWduYXR1cmUnLCBnZXRTdHJpbmdWKSxcbiAgICAgICAgbmV3IEFyZygnZGF0YScsIGdldENvcmVWYWx1ZSwgeyB2YXJpYWRpYzogdHJ1ZSwgbWFwcGVkOiB0cnVlIH0pXG4gICAgICBdLFxuICAgICAgKHdvcmxkLCB7IHRhcmdldCwgdmFsdWUsIHNpZ25hdHVyZSwgZGF0YSwgZXRhIH0pID0+IHtcbiAgICAgICAgY29uc3QgZW5jb2RlZERhdGEgPSBlbmNvZGVQYXJhbWV0ZXJzKHdvcmxkLCBzaWduYXR1cmUudmFsLCBkYXRhLm1hcChhID0+IGEudmFsKSk7XG4gICAgICAgIGNvbnN0IGVuY29kZWRUcmFuc2FjdGlvbiA9IHdvcmxkLndlYjMuZXRoLmFiaS5lbmNvZGVQYXJhbWV0ZXJzKFxuICAgICAgICAgIFsnYWRkcmVzcycsICd1aW50MjU2JywgJ3N0cmluZycsICdieXRlcycsICd1aW50MjU2J10sXG4gICAgICAgICAgW3RhcmdldC52YWwsIHZhbHVlLnZhbCwgc2lnbmF0dXJlLnZhbCwgZW5jb2RlZERhdGEsIGV0YS52YWxdXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgU3RyaW5nVih3b3JsZC53ZWIzLnV0aWxzLmtlY2NhazI1NihlbmNvZGVkVHJhbnNhY3Rpb24pKSk7XG4gICAgICB9XG4gICAgKSxcbiAgICBuZXcgRmV0Y2hlcjx7IHRpbWVsb2NrOiBUaW1lbG9jazsgdHhIYXNoOiBTdHJpbmdWIH0sIEJvb2xWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBRdWV1ZWRUcmFuc2FjdGlvblxuXG4gICAgICAgICogXCJRdWV1ZWRUcmFuc2FjdGlvbiB0eEhhc2g6PFN0cmluZz5cIiAtIEdldHMgdGhlIGJvb2xlYW4gdmFsdWUgb2YgdGhlIGdpdmVuIHR4SGFzaCBpbiB0aGUgcXVldWVkVHJhbnNhY3Rpb25zIG1hcHBpbmdcbiAgICAgIGAsXG4gICAgICAnUXVldWVkVHJhbnNhY3Rpb24nLFxuICAgICAgW25ldyBBcmcoJ3RpbWVsb2NrJywgZ2V0VGltZWxvY2ssIHsgaW1wbGljaXQ6IHRydWUgfSksIG5ldyBBcmcoJ3R4SGFzaCcsIGdldFN0cmluZ1YpXSxcbiAgICAgICh3b3JsZCwgeyB0aW1lbG9jaywgdHhIYXNoIH0pID0+IHF1ZXVlZFRyYW5zYWN0aW9uKHdvcmxkLCB0aW1lbG9jaywgdHhIYXNoLnZhbClcbiAgICApXG4gIF07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUaW1lbG9ja1ZhbHVlKHdvcmxkOiBXb3JsZCwgZXZlbnQ6IEV2ZW50KTogUHJvbWlzZTxWYWx1ZT4ge1xuICByZXR1cm4gYXdhaXQgZ2V0RmV0Y2hlclZhbHVlPGFueSwgYW55PignVGltZWxvY2snLCB0aW1lbG9ja0ZldGNoZXJzKCksIHdvcmxkLCBldmVudCk7XG59XG4iXX0=