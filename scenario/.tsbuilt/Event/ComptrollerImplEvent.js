"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.processComptrollerImplEvent = exports.comptrollerImplCommands = void 0;
const World_1 = require("../World");
const Invokation_1 = require("../Invokation");
const CoreValue_1 = require("../CoreValue");
const Value_1 = require("../Value");
const Command_1 = require("../Command");
const ComptrollerImplBuilder_1 = require("../Builder/ComptrollerImplBuilder");
const ErrorReporter_1 = require("../ErrorReporter");
const ContractLookup_1 = require("../ContractLookup");
const Verify_1 = require("../Verify");
const Networks_1 = require("../Networks");
async function genComptrollerImpl(world, from, params) {
    let { world: nextWorld, comptrollerImpl, comptrollerImplData } = await ComptrollerImplBuilder_1.buildComptrollerImpl(world, from, params);
    world = nextWorld;
    world = World_1.addAction(world, `Added Comptroller Implementation (${comptrollerImplData.description}) at address ${comptrollerImpl._address}`, comptrollerImplData.invokation);
    return world;
}
async function mergeABI(world, from, comptrollerImpl, unitroller) {
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    return world;
}
async function becomeG1(world, from, comptrollerImpl, unitroller, priceOracleAddr, closeFactor, maxAssets) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address, priceOracleAddr, closeFactor, maxAssets, false), from, ErrorReporter_1.ComptrollerErrorReporter);
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    world = World_1.addAction(world, `Become ${unitroller._address}'s Comptroller Impl with priceOracle=${priceOracleAddr},closeFactor=${closeFactor},maxAssets=${maxAssets}`, invokation);
    return world;
}
// Recome calls `become` on the G1 Comptroller, but passes a flag to not modify any of the initialization variables.
async function recome(world, from, comptrollerImpl, unitroller) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address, '0x0000000000000000000000000000000000000000', 0, 0, true), from, ErrorReporter_1.ComptrollerErrorReporter);
    world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    world = World_1.addAction(world, `Recome ${unitroller._address}'s Comptroller Impl`, invokation);
    return world;
}
async function becomeG2(world, from, comptrollerImpl, unitroller) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address), from, ErrorReporter_1.ComptrollerErrorReporter);
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    world = World_1.addAction(world, `Become ${unitroller._address}'s Comptroller Impl`, invokation);
    return world;
}
async function becomeG3(world, from, comptrollerImpl, unitroller, compRate, compMarkets, otherMarkets) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address, compRate, compMarkets, otherMarkets), from, ErrorReporter_1.ComptrollerErrorReporter);
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    world = World_1.addAction(world, `Become ${unitroller._address}'s Comptroller Impl`, invokation);
    return world;
}
async function becomeG4(world, from, comptrollerImpl, unitroller) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address), from, ErrorReporter_1.ComptrollerErrorReporter);
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    world = World_1.addAction(world, `Become ${unitroller._address}'s Comptroller Impl`, invokation);
    return world;
}
async function becomeG5(world, from, comptrollerImpl, unitroller) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address), from, ErrorReporter_1.ComptrollerErrorReporter);
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    world = World_1.addAction(world, `Become ${unitroller._address}'s Comptroller Impl`, invokation);
    return world;
}
async function becomeG6(world, from, comptrollerImpl, unitroller) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address), from, ErrorReporter_1.ComptrollerErrorReporter);
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    world = World_1.addAction(world, `Become ${unitroller._address}'s Comptroller Impl`, invokation);
    return world;
}
async function become(world, from, comptrollerImpl, unitroller) {
    let invokation = await Invokation_1.invoke(world, comptrollerImpl.methods._become(unitroller._address), from, ErrorReporter_1.ComptrollerErrorReporter);
    if (!world.dryRun) {
        // Skip this specifically on dry runs since it's likely to crash due to a number of reasons
        world = await Networks_1.mergeContractABI(world, 'Comptroller', unitroller, unitroller.name, comptrollerImpl.name);
    }
    world = World_1.addAction(world, `Become ${unitroller._address}'s Comptroller Impl`, invokation);
    return world;
}
async function verifyComptrollerImpl(world, comptrollerImpl, name, contract, apiKey) {
    if (world.isLocalNetwork()) {
        world.printer.printLine(`Politely declining to verify on local network: ${world.network}.`);
    }
    else {
        await Verify_1.verify(world, apiKey, name, contract, comptrollerImpl._address);
    }
    return world;
}
function comptrollerImplCommands() {
    return [
        new Command_1.Command(`
        #### Deploy

        * "ComptrollerImpl Deploy ...comptrollerImplParams" - Generates a new Comptroller Implementation
          * E.g. "ComptrollerImpl Deploy MyScen Scenario"
      `, 'Deploy', [new Command_1.Arg('comptrollerImplParams', CoreValue_1.getEventV, { variadic: true })], (world, from, { comptrollerImplParams }) => genComptrollerImpl(world, from, comptrollerImplParams.val)),
        new Command_1.View(`
        #### Verify

        * "ComptrollerImpl <Impl> Verify apiKey:<String>" - Verifies Comptroller Implemetation in Etherscan
          * E.g. "ComptrollerImpl Verify "myApiKey"
      `, 'Verify', [new Command_1.Arg('comptrollerImplArg', CoreValue_1.getStringV), new Command_1.Arg('apiKey', CoreValue_1.getStringV)], async (world, { comptrollerImplArg, apiKey }) => {
            let [comptrollerImpl, name, data] = await ContractLookup_1.getComptrollerImplData(world, comptrollerImplArg.val);
            return await verifyComptrollerImpl(world, comptrollerImpl, name, data.get('contract'), apiKey.val);
        }, { namePos: 1 }),
        new Command_1.Command(`
        #### BecomeG1

        * "ComptrollerImpl <Impl> BecomeG1 priceOracle:<Number> closeFactor:<Exp> maxAssets:<Number>" - Become the comptroller, if possible.
          * E.g. "ComptrollerImpl MyImpl BecomeG1
      `, 'BecomeG1', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl),
            new Command_1.Arg('priceOracle', CoreValue_1.getAddressV),
            new Command_1.Arg('closeFactor', CoreValue_1.getExpNumberV),
            new Command_1.Arg('maxAssets', CoreValue_1.getNumberV)
        ], (world, from, { unitroller, comptrollerImpl, priceOracle, closeFactor, maxAssets }) => becomeG1(world, from, comptrollerImpl, unitroller, priceOracle.val, closeFactor.encode(), maxAssets.encode()), { namePos: 1 }),
        new Command_1.Command(`
        #### BecomeG2

        * "ComptrollerImpl <Impl> BecomeG2" - Become the comptroller, if possible.
          * E.g. "ComptrollerImpl MyImpl BecomeG2
      `, 'BecomeG2', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl)
        ], (world, from, { unitroller, comptrollerImpl }) => becomeG2(world, from, comptrollerImpl, unitroller), { namePos: 1 }),
        new Command_1.Command(`
        #### BecomeG3

        * "ComptrollerImpl <Impl> BecomeG3 <Rate> <CompMarkets> <OtherMarkets>" - Become the comptroller, if possible.
          * E.g. "ComptrollerImpl MyImpl BecomeG3 0.1e18 [cDAI, cETH, cUSDC]
      `, 'BecomeG3', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl),
            new Command_1.Arg('compRate', CoreValue_1.getNumberV, { default: new Value_1.NumberV(1e18) }),
            new Command_1.Arg('compMarkets', CoreValue_1.getArrayV(CoreValue_1.getAddressV), { default: new Value_1.ArrayV([]) }),
            new Command_1.Arg('otherMarkets', CoreValue_1.getArrayV(CoreValue_1.getAddressV), { default: new Value_1.ArrayV([]) })
        ], (world, from, { unitroller, comptrollerImpl, compRate, compMarkets, otherMarkets }) => {
            return becomeG3(world, from, comptrollerImpl, unitroller, compRate.encode(), compMarkets.val.map(a => a.val), otherMarkets.val.map(a => a.val));
        }, { namePos: 1 }),
        new Command_1.Command(`
        #### BecomeG4
        * "ComptrollerImpl <Impl> BecomeG4" - Become the comptroller, if possible.
          * E.g. "ComptrollerImpl MyImpl BecomeG4
      `, 'BecomeG4', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl)
        ], (world, from, { unitroller, comptrollerImpl }) => {
            return becomeG4(world, from, comptrollerImpl, unitroller);
        }, { namePos: 1 }),
        new Command_1.Command(`
        #### BecomeG5
        * "ComptrollerImpl <Impl> BecomeG5" - Become the comptroller, if possible.
          * E.g. "ComptrollerImpl MyImpl BecomeG5
      `, 'BecomeG5', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl)
        ], (world, from, { unitroller, comptrollerImpl }) => {
            return becomeG5(world, from, comptrollerImpl, unitroller);
        }, { namePos: 1 }),
        new Command_1.Command(`
        #### BecomeG6
        * "ComptrollerImpl <Impl> BecomeG6" - Become the comptroller, if possible.
          * E.g. "ComptrollerImpl MyImpl BecomeG6
      `, 'BecomeG6', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl)
        ], (world, from, { unitroller, comptrollerImpl }) => {
            return becomeG6(world, from, comptrollerImpl, unitroller);
        }, { namePos: 1 }),
        new Command_1.Command(`
        #### Become

        * "ComptrollerImpl <Impl> Become <Rate> <CompMarkets> <OtherMarkets>" - Become the comptroller, if possible.
          * E.g. "ComptrollerImpl MyImpl Become 0.1e18 [cDAI, cETH, cUSDC]
      `, 'Become', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl)
        ], (world, from, { unitroller, comptrollerImpl }) => {
            return become(world, from, comptrollerImpl, unitroller);
        }, { namePos: 1 }),
        new Command_1.Command(`
        #### MergeABI

        * "ComptrollerImpl <Impl> MergeABI" - Merges the ABI, as if it was a become.
          * E.g. "ComptrollerImpl MyImpl MergeABI
      `, 'MergeABI', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl)
        ], (world, from, { unitroller, comptrollerImpl }) => mergeABI(world, from, comptrollerImpl, unitroller), { namePos: 1 }),
        new Command_1.Command(`
        #### Recome

        * "ComptrollerImpl <Impl> Recome" - Recome the comptroller
          * E.g. "ComptrollerImpl MyImpl Recome
      `, 'Recome', [
            new Command_1.Arg('unitroller', ContractLookup_1.getUnitroller, { implicit: true }),
            new Command_1.Arg('comptrollerImpl', ContractLookup_1.getComptrollerImpl)
        ], (world, from, { unitroller, comptrollerImpl }) => recome(world, from, comptrollerImpl, unitroller), { namePos: 1 })
    ];
}
exports.comptrollerImplCommands = comptrollerImplCommands;
async function processComptrollerImplEvent(world, event, from) {
    return await Command_1.processCommandEvent('ComptrollerImpl', comptrollerImplCommands(), world, event, from);
}
exports.processComptrollerImplEvent = processComptrollerImplEvent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29tcHRyb2xsZXJJbXBsRXZlbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvRXZlbnQvQ29tcHRyb2xsZXJJbXBsRXZlbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0Esb0NBQTBEO0FBRzFELDhDQUF1QztBQUN2Qyw0Q0FBc0g7QUFDdEgsb0NBQXNFO0FBQ3RFLHdDQUFxRTtBQUNyRSw4RUFBeUU7QUFDekUsb0RBQTREO0FBQzVELHNEQUE4RjtBQUM5RixzQ0FBbUM7QUFDbkMsMENBQStDO0FBSS9DLEtBQUssVUFBVSxrQkFBa0IsQ0FBQyxLQUFZLEVBQUUsSUFBWSxFQUFFLE1BQWE7SUFDekUsSUFBSSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFFLG1CQUFtQixFQUFFLEdBQUcsTUFBTSw2Q0FBb0IsQ0FDekYsS0FBSyxFQUNMLElBQUksRUFDSixNQUFNLENBQ1AsQ0FBQztJQUNGLEtBQUssR0FBRyxTQUFTLENBQUM7SUFFbEIsS0FBSyxHQUFHLGlCQUFTLENBQ2YsS0FBSyxFQUNMLHFDQUFxQyxtQkFBbUIsQ0FBQyxXQUFXLGdCQUFnQixlQUFlLENBQUMsUUFBUSxFQUFFLEVBQzlHLG1CQUFtQixDQUFDLFVBQVUsQ0FDL0IsQ0FBQztJQUVGLE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVELEtBQUssVUFBVSxRQUFRLENBQ3JCLEtBQVksRUFDWixJQUFZLEVBQ1osZUFBZ0MsRUFDaEMsVUFBc0I7SUFFdEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUU7UUFDakIsMkZBQTJGO1FBQzNGLEtBQUssR0FBRyxNQUFNLDJCQUFnQixDQUFDLEtBQUssRUFBRSxhQUFhLEVBQUUsVUFBVSxFQUFFLFVBQVUsQ0FBQyxJQUFJLEVBQUUsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3pHO0lBRUQsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRUQsS0FBSyxVQUFVLFFBQVEsQ0FDckIs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ZGRBY3Rpb24sIGRlc2NyaWJlVXNlciwgV29ybGQgfSBmcm9tICcuLi9Xb3JsZCc7XG5pbXBvcnQgeyBDb21wdHJvbGxlckltcGwgfSBmcm9tICcuLi9Db250cmFjdC9Db21wdHJvbGxlckltcGwnO1xuaW1wb3J0IHsgVW5pdHJvbGxlciB9IGZyb20gJy4uL0NvbnRyYWN0L1VuaXRyb2xsZXInO1xuaW1wb3J0IHsgaW52b2tlIH0gZnJvbSAnLi4vSW52b2thdGlvbic7XG5pbXBvcnQgeyBnZXRBZGRyZXNzViwgZ2V0QXJyYXlWLCBnZXRFdmVudFYsIGdldEV4cE51bWJlclYsIGdldE51bWJlclYsIGdldFN0cmluZ1YsIGdldENvcmVWYWx1ZSB9IGZyb20gJy4uL0NvcmVWYWx1ZSc7XG5pbXBvcnQgeyBBcnJheVYsIEFkZHJlc3NWLCBFdmVudFYsIE51bWJlclYsIFN0cmluZ1YgfSBmcm9tICcuLi9WYWx1ZSc7XG5pbXBvcnQgeyBBcmcsIENvbW1hbmQsIFZpZXcsIHByb2Nlc3NDb21tYW5kRXZlbnQgfSBmcm9tICcuLi9Db21tYW5kJztcbmltcG9ydCB7IGJ1aWxkQ29tcHRyb2xsZXJJbXBsIH0gZnJvbSAnLi4vQnVpbGRlci9Db21wdHJvbGxlckltcGxCdWlsZGVyJztcbmltcG9ydCB7IENvbXB0cm9sbGVyRXJyb3JSZXBvcnRlciB9IGZyb20gJy4uL0Vycm9yUmVwb3J0ZXInO1xuaW1wb3J0IHsgZ2V0Q29tcHRyb2xsZXJJbXBsLCBnZXRDb21wdHJvbGxlckltcGxEYXRhLCBnZXRVbml0cm9sbGVyIH0gZnJvbSAnLi4vQ29udHJhY3RMb29rdXAnO1xuaW1wb3J0IHsgdmVyaWZ5IH0gZnJvbSAnLi4vVmVyaWZ5JztcbmltcG9ydCB7IG1lcmdlQ29udHJhY3RBQkkgfSBmcm9tICcuLi9OZXR3b3Jrcyc7XG5pbXBvcnQgeyBlbmNvZGVkTnVtYmVyIH0gZnJvbSAnLi4vRW5jb2RpbmcnO1xuaW1wb3J0IHsgZW5jb2RlQUJJIH0gZnJvbSAnLi4vVXRpbHMnO1xuXG5hc3luYyBmdW5jdGlvbiBnZW5Db21wdHJvbGxlckltcGwod29ybGQ6IFdvcmxkLCBmcm9tOiBzdHJpbmcsIHBhcmFtczogRXZlbnQpOiBQcm9taXNlPFdvcmxkPiB7XG4gIGxldCB7IHdvcmxkOiBuZXh0V29ybGQsIGNvbXB0cm9sbGVySW1wbCwgY29tcHRyb2xsZXJJbXBsRGF0YSB9ID0gYXdhaXQgYnVpbGRDb21wdHJvbGxlckltcGwoXG4gICAgd29ybGQsXG4gICAgZnJvbSxcbiAgICBwYXJhbXNcbiAgKTtcbiAgd29ybGQgPSBuZXh0V29ybGQ7XG5cbiAgd29ybGQgPSBhZGRBY3Rpb24oXG4gICAgd29ybGQsXG4gICAgYEFkZGVkIENvbXB0cm9sbGVyIEltcGxlbWVudGF0aW9uICgke2NvbXB0cm9sbGVySW1wbERhdGEuZGVzY3JpcHRpb259KSBhdCBhZGRyZXNzICR7Y29tcHRyb2xsZXJJbXBsLl9hZGRyZXNzfWAsXG4gICAgY29tcHRyb2xsZXJJbXBsRGF0YS5pbnZva2F0aW9uXG4gICk7XG5cbiAgcmV0dXJuIHdvcmxkO1xufVxuXG5hc3luYyBmdW5jdGlvbiBtZXJnZUFCSShcbiAgd29ybGQ6IFdvcmxkLFxuICBmcm9tOiBzdHJpbmcsXG4gIGNvbXB0cm9sbGVySW1wbDogQ29tcHRyb2xsZXJJbXBsLFxuICB1bml0cm9sbGVyOiBVbml0cm9sbGVyXG4pOiBQcm9taXNlPFdvcmxkPiB7XG4gIGlmICghd29ybGQuZHJ5UnVuKSB7XG4gICAgLy8gU2tpcCB0aGlzIHNwZWNpZmljYWxseSBvbiBkcnkgcnVucyBzaW5jZSBpdCdzIGxpa2VseSB0byBjcmFzaCBkdWUgdG8gYSBudW1iZXIgb2YgcmVhc29uc1xuICAgIHdvcmxkID0gYXdhaXQgbWVyZ2VDb250cmFjdEFCSSh3b3JsZCwgJ0NvbXB0cm9sbGVyJywgdW5pdHJvbGxlciwgdW5pdHJvbGxlci5uYW1lLCBjb21wdHJvbGxlckltcGwubmFtZSk7XG4gIH1cblxuICByZXR1cm4gd29ybGQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGJlY29tZUcxKFxuICB3b3JsZDogV29ybGQsXG4gIGZyb206IHN0cmluZyxcbiAgY29tcHRyb2xsZXJJbXBsOiBDb21wdHJvbGxlckltcGwsXG4gIHVuaXRyb2xsZXI6IFVuaXRyb2xsZXIsXG4gIHByaWNlT3JhY2xlQWRkcjogc3RyaW5nLFxuICBjbG9zZUZhY3RvcjogZW5jb2RlZE51bWJlcixcbiAgbWF4QXNzZXRzOiBlbmNvZGVkTnVtYmVyXG4pOiBQcm9taXNlPFdvcmxkPiB7XG4gIGxldCBpbnZva2F0aW9uID0gYXdhaXQgaW52b2tlKFxuICAgIHdvcmxkLFxuICAgIGNvbXB0cm9sbGVySW1wbC5tZXRob2RzLl9iZWNvbWUodW5pdHJvbGxlci5fYWRkcmVzcywgcHJpY2VPcmFjbGVBZGRyLCBjbG9zZUZhY3RvciwgbWF4QXNzZXRzLCBmYWxzZSksXG4gICAgZnJvbSxcbiAgICBDb21wdHJvbGxlckVycm9yUmVwb3J0ZXJcbiAgKTtcbiAgaWYgKCF3b3JsZC5kcnlSdW4pIHtcbiAgICAvLyBTa2lwIHRoaXMgc3BlY2lmaWNhbGx5IG9uIGRyeSBydW5zIHNpbmNlIGl0J3MgbGlrZWx5IHRvIGNyYXNoIGR1ZSB0byBhIG51bWJlciBvZiByZWFzb25zXG4gICAgd29ybGQgPSBhd2FpdCBtZXJnZUNvbnRyYWN0QUJJKHdvcmxkLCAnQ29tcHRyb2xsZXInLCB1bml0cm9sbGVyLCB1bml0cm9sbGVyLm5hbWUsIGNvbXB0cm9sbGVySW1wbC5uYW1lKTtcbiAgfVxuXG4gIHdvcmxkID0gYWRkQWN0aW9uKFxuICAgIHdvcmxkLFxuICAgIGBCZWNvbWUgJHt1bml0cm9sbGVyLl9hZGRyZXNzfSdzIENvbXB0cm9sbGVyIEltcGwgd2l0aCBwcmljZU9yYWNsZT0ke3ByaWNlT3JhY2xlQWRkcn0sY2xvc2VGYWN0b3I9JHtjbG9zZUZhY3Rvcn0sbWF4QXNzZXRzPSR7bWF4QXNzZXRzfWAsXG4gICAgaW52b2thdGlvblxuICApO1xuXG4gIHJldHVybiB3b3JsZDtcbn1cblxuLy8gUmVjb21lIGNhbGxzIGBiZWNvbWVgIG9uIHRoZSBHMSBDb21wdHJvbGxlciwgYnV0IHBhc3NlcyBhIGZsYWcgdG8gbm90IG1vZGlmeSBhbnkgb2YgdGhlIGluaXRpYWxpemF0aW9uIHZhcmlhYmxlcy5cbmFzeW5jIGZ1bmN0aW9uIHJlY29tZShcbiAgd29ybGQ6IFdvcmxkLFxuICBmcm9tOiBzdHJpbmcsXG4gIGNvbXB0cm9sbGVySW1wbDogQ29tcHRyb2xsZXJJbXBsLFxuICB1bml0cm9sbGVyOiBVbml0cm9sbGVyXG4pOiBQcm9taXNlPFdvcmxkPiB7XG4gIGxldCBpbnZva2F0aW9uID0gYXdhaXQgaW52b2tlKFxuICAgIHdvcmxkLFxuICAgIGNvbXB0cm9sbGVySW1wbC5tZXRob2RzLl9iZWNvbWUoXG4gICAgICB1bml0cm9sbGVyLl9hZGRyZXNzLFxuICAgICAgJzB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCcsXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIHRydWVcbiAgICApLFxuICAgIGZyb20sXG4gICAgQ29tcHRyb2xsZXJFcnJvclJlcG9ydGVyXG4gICk7XG5cbiAgd29ybGQgPSBhd2FpdCBtZXJnZUNvbnRyYWN0QUJJKHdvcmxkLCAnQ29tcHRyb2xsZXInLCB1bml0cm9sbGVyLCB1bml0cm9sbGVyLm5hbWUsIGNvbXB0cm9sbGVySW1wbC5uYW1lKTtcblxuICB3b3JsZCA9IGFkZEFjdGlvbih3b3JsZCwgYFJlY29tZSAke3VuaXRyb2xsZXIuX2FkZHJlc3N9J3MgQ29tcHRyb2xsZXIgSW1wbGAsIGludm9rYXRpb24pO1xuXG4gIHJldHVybiB3b3JsZDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gYmVjb21lRzIoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZnJvbTogc3RyaW5nLFxuICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbCxcbiAgdW5pdHJvbGxlcjogVW5pdHJvbGxlclxuKTogUHJvbWlzZTxXb3JsZD4ge1xuICBsZXQgaW52b2thdGlvbiA9IGF3YWl0IGludm9rZShcbiAgICB3b3JsZCxcbiAgICBjb21wdHJvbGxlckltcGwubWV0aG9kcy5fYmVjb21lKHVuaXRyb2xsZXIuX2FkZHJlc3MpLFxuICAgIGZyb20sXG4gICAgQ29tcHRyb2xsZXJFcnJvclJlcG9ydGVyXG4gICk7XG5cbiAgaWYgKCF3b3JsZC5kcnlSdW4pIHtcbiAgICAvLyBTa2lwIHRoaXMgc3BlY2lmaWNhbGx5IG9uIGRyeSBydW5zIHNpbmNlIGl0J3MgbGlrZWx5IHRvIGNyYXNoIGR1ZSB0byBhIG51bWJlciBvZiByZWFzb25zXG4gICAgd29ybGQgPSBhd2FpdCBtZXJnZUNvbnRyYWN0QUJJKHdvcmxkLCAnQ29tcHRyb2xsZXInLCB1bml0cm9sbGVyLCB1bml0cm9sbGVyLm5hbWUsIGNvbXB0cm9sbGVySW1wbC5uYW1lKTtcbiAgfVxuXG4gIHdvcmxkID0gYWRkQWN0aW9uKHdvcmxkLCBgQmVjb21lICR7dW5pdHJvbGxlci5fYWRkcmVzc30ncyBDb21wdHJvbGxlciBJbXBsYCwgaW52b2thdGlvbik7XG5cbiAgcmV0dXJuIHdvcmxkO1xufVxuXG5hc3luYyBmdW5jdGlvbiBiZWNvbWVHMyhcbiAgd29ybGQ6IFdvcmxkLFxuICBmcm9tOiBzdHJpbmcsXG4gIGNvbXB0cm9sbGVySW1wbDogQ29tcHRyb2xsZXJJbXBsLFxuICB1bml0cm9sbGVyOiBVbml0cm9sbGVyLFxuICBjb21wUmF0ZTogZW5jb2RlZE51bWJlcixcbiAgY29tcE1hcmtldHM6IHN0cmluZ1tdLFxuICBvdGhlck1hcmtldHM6IHN0cmluZ1tdXG4pOiBQcm9taXNlPFdvcmxkPiB7XG4gIGxldCBpbnZva2F0aW9uID0gYXdhaXQgaW52b2tlKFxuICAgIHdvcmxkLFxuICAgIGNvbXB0cm9sbGVySW1wbC5tZXRob2RzLl9iZWNvbWUodW5pdHJvbGxlci5fYWRkcmVzcywgY29tcFJhdGUsIGNvbXBNYXJrZXRzLCBvdGhlck1hcmtldHMpLFxuICAgIGZyb20sXG4gICAgQ29tcHRyb2xsZXJFcnJvclJlcG9ydGVyXG4gICk7XG5cbiAgaWYgKCF3b3JsZC5kcnlSdW4pIHtcbiAgICAvLyBTa2lwIHRoaXMgc3BlY2lmaWNhbGx5IG9uIGRyeSBydW5zIHNpbmNlIGl0J3MgbGlrZWx5IHRvIGNyYXNoIGR1ZSB0byBhIG51bWJlciBvZiByZWFzb25zXG4gICAgd29ybGQgPSBhd2FpdCBtZXJnZUNvbnRyYWN0QUJJKHdvcmxkLCAnQ29tcHRyb2xsZXInLCB1bml0cm9sbGVyLCB1bml0cm9sbGVyLm5hbWUsIGNvbXB0cm9sbGVySW1wbC5uYW1lKTtcbiAgfVxuXG4gIHdvcmxkID0gYWRkQWN0aW9uKHdvcmxkLCBgQmVjb21lICR7dW5pdHJvbGxlci5fYWRkcmVzc30ncyBDb21wdHJvbGxlciBJbXBsYCwgaW52b2thdGlvbik7XG5cbiAgcmV0dXJuIHdvcmxkO1xufVxuXG5hc3luYyBmdW5jdGlvbiBiZWNvbWVHNChcbiAgd29ybGQ6IFdvcmxkLFxuICBmcm9tOiBzdHJpbmcsXG4gIGNvbXB0cm9sbGVySW1wbDogQ29tcHRyb2xsZXJJbXBsLFxuICB1bml0cm9sbGVyOiBVbml0cm9sbGVyXG4pOiBQcm9taXNlPFdvcmxkPiB7XG4gIGxldCBpbnZva2F0aW9uID0gYXdhaXQgaW52b2tlKFxuICAgIHdvcmxkLFxuICAgIGNvbXB0cm9sbGVySW1wbC5tZXRob2RzLl9iZWNvbWUodW5pdHJvbGxlci5fYWRkcmVzcyksXG4gICAgZnJvbSxcbiAgICBDb21wdHJvbGxlckVycm9yUmVwb3J0ZXJcbiAgKTtcblxuICBpZiAoIXdvcmxkLmRyeVJ1bikge1xuICAgIC8vIFNraXAgdGhpcyBzcGVjaWZpY2FsbHkgb24gZHJ5IHJ1bnMgc2luY2UgaXQncyBsaWtlbHkgdG8gY3Jhc2ggZHVlIHRvIGEgbnVtYmVyIG9mIHJlYXNvbnNcbiAgICB3b3JsZCA9IGF3YWl0IG1lcmdlQ29udHJhY3RBQkkod29ybGQsICdDb21wdHJvbGxlcicsIHVuaXRyb2xsZXIsIHVuaXRyb2xsZXIubmFtZSwgY29tcHRyb2xsZXJJbXBsLm5hbWUpO1xuICB9XG5cbiAgd29ybGQgPSBhZGRBY3Rpb24od29ybGQsIGBCZWNvbWUgJHt1bml0cm9sbGVyLl9hZGRyZXNzfSdzIENvbXB0cm9sbGVyIEltcGxgLCBpbnZva2F0aW9uKTtcblxuICByZXR1cm4gd29ybGQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGJlY29tZUc1KFxuICB3b3JsZDogV29ybGQsXG4gIGZyb206IHN0cmluZyxcbiAgY29tcHRyb2xsZXJJbXBsOiBDb21wdHJvbGxlckltcGwsXG4gIHVuaXRyb2xsZXI6IFVuaXRyb2xsZXJcbik6IFByb21pc2U8V29ybGQ+IHtcbiAgbGV0IGludm9rYXRpb24gPSBhd2FpdCBpbnZva2UoXG4gICAgd29ybGQsXG4gICAgY29tcHRyb2xsZXJJbXBsLm1ldGhvZHMuX2JlY29tZSh1bml0cm9sbGVyLl9hZGRyZXNzKSxcbiAgICBmcm9tLFxuICAgIENvbXB0cm9sbGVyRXJyb3JSZXBvcnRlclxuICApO1xuXG4gIGlmICghd29ybGQuZHJ5UnVuKSB7XG4gICAgLy8gU2tpcCB0aGlzIHNwZWNpZmljYWxseSBvbiBkcnkgcnVucyBzaW5jZSBpdCdzIGxpa2VseSB0byBjcmFzaCBkdWUgdG8gYSBudW1iZXIgb2YgcmVhc29uc1xuICAgIHdvcmxkID0gYXdhaXQgbWVyZ2VDb250cmFjdEFCSSh3b3JsZCwgJ0NvbXB0cm9sbGVyJywgdW5pdHJvbGxlciwgdW5pdHJvbGxlci5uYW1lLCBjb21wdHJvbGxlckltcGwubmFtZSk7XG4gIH1cblxuICB3b3JsZCA9IGFkZEFjdGlvbih3b3JsZCwgYEJlY29tZSAke3VuaXRyb2xsZXIuX2FkZHJlc3N9J3MgQ29tcHRyb2xsZXIgSW1wbGAsIGludm9rYXRpb24pO1xuXG4gIHJldHVybiB3b3JsZDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gYmVjb21lRzYoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZnJvbTogc3RyaW5nLFxuICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbCxcbiAgdW5pdHJvbGxlcjogVW5pdHJvbGxlclxuKTogUHJvbWlzZTxXb3JsZD4ge1xuICBsZXQgaW52b2thdGlvbiA9IGF3YWl0IGludm9rZShcbiAgICB3b3JsZCxcbiAgICBjb21wdHJvbGxlckltcGwubWV0aG9kcy5fYmVjb21lKHVuaXRyb2xsZXIuX2FkZHJlc3MpLFxuICAgIGZyb20sXG4gICAgQ29tcHRyb2xsZXJFcnJvclJlcG9ydGVyXG4gICk7XG5cbiAgaWYgKCF3b3JsZC5kcnlSdW4pIHtcbiAgICAvLyBTa2lwIHRoaXMgc3BlY2lmaWNhbGx5IG9uIGRyeSBydW5zIHNpbmNlIGl0J3MgbGlrZWx5IHRvIGNyYXNoIGR1ZSB0byBhIG51bWJlciBvZiByZWFzb25zXG4gICAgd29ybGQgPSBhd2FpdCBtZXJnZUNvbnRyYWN0QUJJKHdvcmxkLCAnQ29tcHRyb2xsZXInLCB1bml0cm9sbGVyLCB1bml0cm9sbGVyLm5hbWUsIGNvbXB0cm9sbGVySW1wbC5uYW1lKTtcbiAgfVxuXG4gIHdvcmxkID0gYWRkQWN0aW9uKHdvcmxkLCBgQmVjb21lICR7dW5pdHJvbGxlci5fYWRkcmVzc30ncyBDb21wdHJvbGxlciBJbXBsYCwgaW52b2thdGlvbik7XG5cbiAgcmV0dXJuIHdvcmxkO1xufVxuXG5hc3luYyBmdW5jdGlvbiBiZWNvbWUoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZnJvbTogc3RyaW5nLFxuICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbCxcbiAgdW5pdHJvbGxlcjogVW5pdHJvbGxlclxuKTogUHJvbWlzZTxXb3JsZD4ge1xuICBsZXQgaW52b2thdGlvbiA9IGF3YWl0IGludm9rZShcbiAgICB3b3JsZCxcbiAgICBjb21wdHJvbGxlckltcGwubWV0aG9kcy5fYmVjb21lKHVuaXRyb2xsZXIuX2FkZHJlc3MpLFxuICAgIGZyb20sXG4gICAgQ29tcHRyb2xsZXJFcnJvclJlcG9ydGVyXG4gICk7XG5cbiAgaWYgKCF3b3JsZC5kcnlSdW4pIHtcbiAgICAvLyBTa2lwIHRoaXMgc3BlY2lmaWNhbGx5IG9uIGRyeSBydW5zIHNpbmNlIGl0J3MgbGlrZWx5IHRvIGNyYXNoIGR1ZSB0byBhIG51bWJlciBvZiByZWFzb25zXG4gICAgd29ybGQgPSBhd2FpdCBtZXJnZUNvbnRyYWN0QUJJKHdvcmxkLCAnQ29tcHRyb2xsZXInLCB1bml0cm9sbGVyLCB1bml0cm9sbGVyLm5hbWUsIGNvbXB0cm9sbGVySW1wbC5uYW1lKTtcbiAgfVxuXG4gIHdvcmxkID0gYWRkQWN0aW9uKHdvcmxkLCBgQmVjb21lICR7dW5pdHJvbGxlci5fYWRkcmVzc30ncyBDb21wdHJvbGxlciBJbXBsYCwgaW52b2thdGlvbik7XG5cbiAgcmV0dXJuIHdvcmxkO1xufVxuXG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlDb21wdHJvbGxlckltcGwoXG4gIHdvcmxkOiBXb3JsZCxcbiAgY29tcHRyb2xsZXJJbXBsOiBDb21wdHJvbGxlckltcGwsXG4gIG5hbWU6IHN0cmluZyxcbiAgY29udHJhY3Q6IHN0cmluZyxcbiAgYXBpS2V5OiBzdHJpbmdcbik6IFByb21pc2U8V29ybGQ+IHtcbiAgaWYgKHdvcmxkLmlzTG9jYWxOZXR3b3JrKCkpIHtcbiAgICB3b3JsZC5wcmludGVyLnByaW50TGluZShgUG9saXRlbHkgZGVjbGluaW5nIHRvIHZlcmlmeSBvbiBsb2NhbCBuZXR3b3JrOiAke3dvcmxkLm5ldHdvcmt9LmApO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IHZlcmlmeSh3b3JsZCwgYXBpS2V5LCBuYW1lLCBjb250cmFjdCwgY29tcHRyb2xsZXJJbXBsLl9hZGRyZXNzKTtcbiAgfVxuXG4gIHJldHVybiB3b3JsZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB0cm9sbGVySW1wbENvbW1hbmRzKCkge1xuICByZXR1cm4gW1xuICAgIG5ldyBDb21tYW5kPHsgY29tcHRyb2xsZXJJbXBsUGFyYW1zOiBFdmVudFYgfT4oXG4gICAgICBgXG4gICAgICAgICMjIyMgRGVwbG95XG5cbiAgICAgICAgKiBcIkNvbXB0cm9sbGVySW1wbCBEZXBsb3kgLi4uY29tcHRyb2xsZXJJbXBsUGFyYW1zXCIgLSBHZW5lcmF0ZXMgYSBuZXcgQ29tcHRyb2xsZXIgSW1wbGVtZW50YXRpb25cbiAgICAgICAgICAqIEUuZy4gXCJDb21wdHJvbGxlckltcGwgRGVwbG95IE15U2NlbiBTY2VuYXJpb1wiXG4gICAgICBgLFxuICAgICAgJ0RlcGxveScsXG4gICAgICBbbmV3IEFyZygnY29tcHRyb2xsZXJJbXBsUGFyYW1zJywgZ2V0RXZlbnRWLCB7IHZhcmlhZGljOiB0cnVlIH0pXSxcbiAgICAgICh3b3JsZCwgZnJvbSwgeyBjb21wdHJvbGxlckltcGxQYXJhbXMgfSkgPT4gZ2VuQ29tcHRyb2xsZXJJbXBsKHdvcmxkLCBmcm9tLCBjb21wdHJvbGxlckltcGxQYXJhbXMudmFsKVxuICAgICksXG4gICAgbmV3IFZpZXc8eyBjb21wdHJvbGxlckltcGxBcmc6IFN0cmluZ1Y7IGFwaUtleTogU3RyaW5nViB9PihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBWZXJpZnlcblxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBWZXJpZnkgYXBpS2V5OjxTdHJpbmc+XCIgLSBWZXJpZmllcyBDb21wdHJvbGxlciBJbXBsZW1ldGF0aW9uIGluIEV0aGVyc2NhblxuICAgICAgICAgICogRS5nLiBcIkNvbXB0cm9sbGVySW1wbCBWZXJpZnkgXCJteUFwaUtleVwiXG4gICAgICBgLFxuICAgICAgJ1ZlcmlmeScsXG4gICAgICBbbmV3IEFyZygnY29tcHRyb2xsZXJJbXBsQXJnJywgZ2V0U3RyaW5nViksIG5ldyBBcmcoJ2FwaUtleScsIGdldFN0cmluZ1YpXSxcbiAgICAgIGFzeW5jICh3b3JsZCwgeyBjb21wdHJvbGxlckltcGxBcmcsIGFwaUtleSB9KSA9PiB7XG4gICAgICAgIGxldCBbY29tcHRyb2xsZXJJbXBsLCBuYW1lLCBkYXRhXSA9IGF3YWl0IGdldENvbXB0cm9sbGVySW1wbERhdGEod29ybGQsIGNvbXB0cm9sbGVySW1wbEFyZy52YWwpO1xuXG4gICAgICAgIHJldHVybiBhd2FpdCB2ZXJpZnlDb21wdHJvbGxlckltcGwod29ybGQsIGNvbXB0cm9sbGVySW1wbCwgbmFtZSwgZGF0YS5nZXQoJ2NvbnRyYWN0JykhLCBhcGlLZXkudmFsKTtcbiAgICAgIH0sXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG4gICAgbmV3IENvbW1hbmQ8e1xuICAgICAgdW5pdHJvbGxlcjogVW5pdHJvbGxlcjtcbiAgICAgIGNvbXB0cm9sbGVySW1wbDogQ29tcHRyb2xsZXJJbXBsO1xuICAgICAgcHJpY2VPcmFjbGU6IEFkZHJlc3NWO1xuICAgICAgY2xvc2VGYWN0b3I6IE51bWJlclY7XG4gICAgICBtYXhBc3NldHM6IE51bWJlclY7XG4gICAgfT4oXG4gICAgICBgXG4gICAgICAgICMjIyMgQmVjb21lRzFcblxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBCZWNvbWVHMSBwcmljZU9yYWNsZTo8TnVtYmVyPiBjbG9zZUZhY3Rvcjo8RXhwPiBtYXhBc3NldHM6PE51bWJlcj5cIiAtIEJlY29tZSB0aGUgY29tcHRyb2xsZXIsIGlmIHBvc3NpYmxlLlxuICAgICAgICAgICogRS5nLiBcIkNvbXB0cm9sbGVySW1wbCBNeUltcGwgQmVjb21lRzFcbiAgICAgIGAsXG4gICAgICAnQmVjb21lRzEnLFxuICAgICAgW1xuICAgICAgICBuZXcgQXJnKCd1bml0cm9sbGVyJywgZ2V0VW5pdHJvbGxlciwgeyBpbXBsaWNpdDogdHJ1ZSB9KSxcbiAgICAgICAgbmV3IEFyZygnY29tcHRyb2xsZXJJbXBsJywgZ2V0Q29tcHRyb2xsZXJJbXBsKSxcbiAgICAgICAgbmV3IEFyZygncHJpY2VPcmFjbGUnLCBnZXRBZGRyZXNzViksXG4gICAgICAgIG5ldyBBcmcoJ2Nsb3NlRmFjdG9yJywgZ2V0RXhwTnVtYmVyViksXG4gICAgICAgIG5ldyBBcmcoJ21heEFzc2V0cycsIGdldE51bWJlclYpXG4gICAgICBdLFxuICAgICAgKHdvcmxkLCBmcm9tLCB7IHVuaXRyb2xsZXIsIGNvbXB0cm9sbGVySW1wbCwgcHJpY2VPcmFjbGUsIGNsb3NlRmFjdG9yLCBtYXhBc3NldHMgfSkgPT5cbiAgICAgICAgYmVjb21lRzEoXG4gICAgICAgICAgd29ybGQsXG4gICAgICAgICAgZnJvbSxcbiAgICAgICAgICBjb21wdHJvbGxlckltcGwsXG4gICAgICAgICAgdW5pdHJvbGxlcixcbiAgICAgICAgICBwcmljZU9yYWNsZS52YWwsXG4gICAgICAgICAgY2xvc2VGYWN0b3IuZW5jb2RlKCksXG4gICAgICAgICAgbWF4QXNzZXRzLmVuY29kZSgpXG4gICAgICAgICksXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgQ29tbWFuZDx7XG4gICAgICB1bml0cm9sbGVyOiBVbml0cm9sbGVyO1xuICAgICAgY29tcHRyb2xsZXJJbXBsOiBDb21wdHJvbGxlckltcGw7XG4gICAgfT4oXG4gICAgICBgXG4gICAgICAgICMjIyMgQmVjb21lRzJcblxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBCZWNvbWVHMlwiIC0gQmVjb21lIHRoZSBjb21wdHJvbGxlciwgaWYgcG9zc2libGUuXG4gICAgICAgICAgKiBFLmcuIFwiQ29tcHRyb2xsZXJJbXBsIE15SW1wbCBCZWNvbWVHMlxuICAgICAgYCxcbiAgICAgICdCZWNvbWVHMicsXG4gICAgICBbXG4gICAgICAgIG5ldyBBcmcoJ3VuaXRyb2xsZXInLCBnZXRVbml0cm9sbGVyLCB7IGltcGxpY2l0OiB0cnVlIH0pLFxuICAgICAgICBuZXcgQXJnKCdjb21wdHJvbGxlckltcGwnLCBnZXRDb21wdHJvbGxlckltcGwpXG4gICAgICBdLFxuICAgICAgKHdvcmxkLCBmcm9tLCB7IHVuaXRyb2xsZXIsIGNvbXB0cm9sbGVySW1wbCB9KSA9PiBiZWNvbWVHMih3b3JsZCwgZnJvbSwgY29tcHRyb2xsZXJJbXBsLCB1bml0cm9sbGVyKSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBDb21tYW5kPHtcbiAgICAgIHVuaXRyb2xsZXI6IFVuaXRyb2xsZXI7XG4gICAgICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbDtcbiAgICAgIGNvbXBSYXRlOiBOdW1iZXJWO1xuICAgICAgY29tcE1hcmtldHM6IEFycmF5VjxBZGRyZXNzVj47XG4gICAgICBvdGhlck1hcmtldHM6IEFycmF5VjxBZGRyZXNzVj47XG4gICAgfT4oXG4gICAgICBgXG4gICAgICAgICMjIyMgQmVjb21lRzNcblxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBCZWNvbWVHMyA8UmF0ZT4gPENvbXBNYXJrZXRzPiA8T3RoZXJNYXJrZXRzPlwiIC0gQmVjb21lIHRoZSBjb21wdHJvbGxlciwgaWYgcG9zc2libGUuXG4gICAgICAgICAgKiBFLmcuIFwiQ29tcHRyb2xsZXJJbXBsIE15SW1wbCBCZWNvbWVHMyAwLjFlMTggW2NEQUksIGNFVEgsIGNVU0RDXVxuICAgICAgYCxcbiAgICAgICdCZWNvbWVHMycsXG4gICAgICBbXG4gICAgICAgIG5ldyBBcmcoJ3VuaXRyb2xsZXInLCBnZXRVbml0cm9sbGVyLCB7IGltcGxpY2l0OiB0cnVlIH0pLFxuICAgICAgICBuZXcgQXJnKCdjb21wdHJvbGxlckltcGwnLCBnZXRDb21wdHJvbGxlckltcGwpLFxuICAgICAgICBuZXcgQXJnKCdjb21wUmF0ZScsIGdldE51bWJlclYsIHsgZGVmYXVsdDogbmV3IE51bWJlclYoMWUxOCkgfSksXG4gICAgICAgIG5ldyBBcmcoJ2NvbXBNYXJrZXRzJywgZ2V0QXJyYXlWKGdldEFkZHJlc3NWKSwgIHtkZWZhdWx0OiBuZXcgQXJyYXlWKFtdKSB9KSxcbiAgICAgICAgbmV3IEFyZygnb3RoZXJNYXJrZXRzJywgZ2V0QXJyYXlWKGdldEFkZHJlc3NWKSwgeyBkZWZhdWx0OiBuZXcgQXJyYXlWKFtdKSB9KVxuICAgICAgXSxcbiAgICAgICh3b3JsZCwgZnJvbSwgeyB1bml0cm9sbGVyLCBjb21wdHJvbGxlckltcGwsIGNvbXBSYXRlLCBjb21wTWFya2V0cywgb3RoZXJNYXJrZXRzIH0pID0+IHtcbiAgICAgICAgcmV0dXJuIGJlY29tZUczKHdvcmxkLCBmcm9tLCBjb21wdHJvbGxlckltcGwsIHVuaXRyb2xsZXIsIGNvbXBSYXRlLmVuY29kZSgpLCBjb21wTWFya2V0cy52YWwubWFwKGEgPT4gYS52YWwpLCBvdGhlck1hcmtldHMudmFsLm1hcChhID0+IGEudmFsKSlcbiAgICAgIH0sXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG4gIFxuICAgIG5ldyBDb21tYW5kPHtcbiAgICAgIHVuaXRyb2xsZXI6IFVuaXRyb2xsZXI7XG4gICAgICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbDtcbiAgICB9PihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBCZWNvbWVHNFxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBCZWNvbWVHNFwiIC0gQmVjb21lIHRoZSBjb21wdHJvbGxlciwgaWYgcG9zc2libGUuXG4gICAgICAgICAgKiBFLmcuIFwiQ29tcHRyb2xsZXJJbXBsIE15SW1wbCBCZWNvbWVHNFxuICAgICAgYCxcbiAgICAgICdCZWNvbWVHNCcsXG4gICAgICBbXG4gICAgICAgIG5ldyBBcmcoJ3VuaXRyb2xsZXInLCBnZXRVbml0cm9sbGVyLCB7IGltcGxpY2l0OiB0cnVlIH0pLFxuICAgICAgICBuZXcgQXJnKCdjb21wdHJvbGxlckltcGwnLCBnZXRDb21wdHJvbGxlckltcGwpXG4gICAgICBdLFxuICAgICAgKHdvcmxkLCBmcm9tLCB7IHVuaXRyb2xsZXIsIGNvbXB0cm9sbGVySW1wbCB9KSA9PiB7XG4gICAgICAgIHJldHVybiBiZWNvbWVHNCh3b3JsZCwgZnJvbSwgY29tcHRyb2xsZXJJbXBsLCB1bml0cm9sbGVyKVxuICAgICAgfSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBDb21tYW5kPHtcbiAgICAgIHVuaXRyb2xsZXI6IFVuaXRyb2xsZXI7XG4gICAgICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbDtcbiAgICB9PihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBCZWNvbWVHNVxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBCZWNvbWVHNVwiIC0gQmVjb21lIHRoZSBjb21wdHJvbGxlciwgaWYgcG9zc2libGUuXG4gICAgICAgICAgKiBFLmcuIFwiQ29tcHRyb2xsZXJJbXBsIE15SW1wbCBCZWNvbWVHNVxuICAgICAgYCxcbiAgICAgICdCZWNvbWVHNScsXG4gICAgICBbXG4gICAgICAgIG5ldyBBcmcoJ3VuaXRyb2xsZXInLCBnZXRVbml0cm9sbGVyLCB7IGltcGxpY2l0OiB0cnVlIH0pLFxuICAgICAgICBuZXcgQXJnKCdjb21wdHJvbGxlckltcGwnLCBnZXRDb21wdHJvbGxlckltcGwpXG4gICAgICBdLFxuICAgICAgKHdvcmxkLCBmcm9tLCB7IHVuaXRyb2xsZXIsIGNvbXB0cm9sbGVySW1wbCB9KSA9PiB7XG4gICAgICAgIHJldHVybiBiZWNvbWVHNSh3b3JsZCwgZnJvbSwgY29tcHRyb2xsZXJJbXBsLCB1bml0cm9sbGVyKVxuICAgICAgfSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBDb21tYW5kPHtcbiAgICAgIHVuaXRyb2xsZXI6IFVuaXRyb2xsZXI7XG4gICAgICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbDtcbiAgICB9PihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBCZWNvbWVHNlxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBCZWNvbWVHNlwiIC0gQmVjb21lIHRoZSBjb21wdHJvbGxlciwgaWYgcG9zc2libGUuXG4gICAgICAgICAgKiBFLmcuIFwiQ29tcHRyb2xsZXJJbXBsIE15SW1wbCBCZWNvbWVHNlxuICAgICAgYCxcbiAgICAgICdCZWNvbWVHNicsXG4gICAgICBbXG4gICAgICAgIG5ldyBBcmcoJ3VuaXRyb2xsZXInLCBnZXRVbml0cm9sbGVyLCB7IGltcGxpY2l0OiB0cnVlIH0pLFxuICAgICAgICBuZXcgQXJnKCdjb21wdHJvbGxlckltcGwnLCBnZXRDb21wdHJvbGxlckltcGwpXG4gICAgICBdLFxuICAgICAgKHdvcmxkLCBmcm9tLCB7IHVuaXRyb2xsZXIsIGNvbXB0cm9sbGVySW1wbCB9KSA9PiB7XG4gICAgICAgIHJldHVybiBiZWNvbWVHNih3b3JsZCwgZnJvbSwgY29tcHRyb2xsZXJJbXBsLCB1bml0cm9sbGVyKVxuICAgICAgfSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBDb21tYW5kPHtcbiAgICAgIHVuaXRyb2xsZXI6IFVuaXRyb2xsZXI7XG4gICAgICBjb21wdHJvbGxlckltcGw6IENvbXB0cm9sbGVySW1wbDtcbiAgICB9PihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBCZWNvbWVcblxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBCZWNvbWUgPFJhdGU+IDxDb21wTWFya2V0cz4gPE90aGVyTWFya2V0cz5cIiAtIEJlY29tZSB0aGUgY29tcHRyb2xsZXIsIGlmIHBvc3NpYmxlLlxuICAgICAgICAgICogRS5nLiBcIkNvbXB0cm9sbGVySW1wbCBNeUltcGwgQmVjb21lIDAuMWUxOCBbY0RBSSwgY0VUSCwgY1VTRENdXG4gICAgICBgLFxuICAgICAgJ0JlY29tZScsXG4gICAgICBbXG4gICAgICAgIG5ldyBBcmcoJ3VuaXRyb2xsZXInLCBnZXRVbml0cm9sbGVyLCB7IGltcGxpY2l0OiB0cnVlIH0pLFxuICAgICAgICBuZXcgQXJnKCdjb21wdHJvbGxlckltcGwnLCBnZXRDb21wdHJvbGxlckltcGwpXG4gICAgICBdLFxuICAgICAgKHdvcmxkLCBmcm9tLCB7IHVuaXRyb2xsZXIsIGNvbXB0cm9sbGVySW1wbCB9KSA9PiB7XG4gICAgICAgIHJldHVybiBiZWNvbWUod29ybGQsIGZyb20sIGNvbXB0cm9sbGVySW1wbCwgdW5pdHJvbGxlcilcbiAgICAgIH0sXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgQ29tbWFuZDx7XG4gICAgICB1bml0cm9sbGVyOiBVbml0cm9sbGVyO1xuICAgICAgY29tcHRyb2xsZXJJbXBsOiBDb21wdHJvbGxlckltcGw7XG4gICAgfT4oXG4gICAgICBgXG4gICAgICAgICMjIyMgTWVyZ2VBQklcblxuICAgICAgICAqIFwiQ29tcHRyb2xsZXJJbXBsIDxJbXBsPiBNZXJnZUFCSVwiIC0gTWVyZ2VzIHRoZSBBQkksIGFzIGlmIGl0IHdhcyBhIGJlY29tZS5cbiAgICAgICAgICAqIEUuZy4gXCJDb21wdHJvbGxlckltcGwgTXlJbXBsIE1lcmdlQUJJXG4gICAgICBgLFxuICAgICAgJ01lcmdlQUJJJyxcbiAgICAgIFtcbiAgICAgICAgbmV3IEFyZygndW5pdHJvbGxlcicsIGdldFVuaXRyb2xsZXIsIHsgaW1wbGljaXQ6IHRydWUgfSksXG4gICAgICAgIG5ldyBBcmcoJ2NvbXB0cm9sbGVySW1wbCcsIGdldENvbXB0cm9sbGVySW1wbClcbiAgICAgIF0sXG4gICAgICAod29ybGQsIGZyb20sIHsgdW5pdHJvbGxlciwgY29tcHRyb2xsZXJJbXBsIH0pID0+IG1lcmdlQUJJKHdvcmxkLCBmcm9tLCBjb21wdHJvbGxlckltcGwsIHVuaXRyb2xsZXIpLFxuICAgICAgeyBuYW1lUG9zOiAxIH1cbiAgICApLFxuICAgIG5ldyBDb21tYW5kPHsgdW5pdHJvbGxlcjogVW5pdHJvbGxlcjsgY29tcHRyb2xsZXJJbXBsOiBDb21wdHJvbGxlckltcGwgfT4oXG4gICAgICBgXG4gICAgICAgICMjIyMgUmVjb21lXG5cbiAgICAgICAgKiBcIkNvbXB0cm9sbGVySW1wbCA8SW1wbD4gUmVjb21lXCIgLSBSZWNvbWUgdGhlIGNvbXB0cm9sbGVyXG4gICAgICAgICAgKiBFLmcuIFwiQ29tcHRyb2xsZXJJbXBsIE15SW1wbCBSZWNvbWVcbiAgICAgIGAsXG4gICAgICAnUmVjb21lJyxcbiAgICAgIFtcbiAgICAgICAgbmV3IEFyZygndW5pdHJvbGxlcicsIGdldFVuaXRyb2xsZXIsIHsgaW1wbGljaXQ6IHRydWUgfSksXG4gICAgICAgIG5ldyBBcmcoJ2NvbXB0cm9sbGVySW1wbCcsIGdldENvbXB0cm9sbGVySW1wbClcbiAgICAgIF0sXG4gICAgICAod29ybGQsIGZyb20sIHsgdW5pdHJvbGxlciwgY29tcHRyb2xsZXJJbXBsIH0pID0+IHJlY29tZSh3b3JsZCwgZnJvbSwgY29tcHRyb2xsZXJJbXBsLCB1bml0cm9sbGVyKSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKVxuICBdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0NvbXB0cm9sbGVySW1wbEV2ZW50KFxuICB3b3JsZDogV29ybGQsXG4gIGV2ZW50OiBFdmVudCxcbiAgZnJvbTogc3RyaW5nIHwgbnVsbFxuKTogUHJvbWlzZTxXb3JsZD4ge1xuICByZXR1cm4gYXdhaXQgcHJvY2Vzc0NvbW1hbmRFdmVudDxhbnk+KCdDb21wdHJvbGxlckltcGwnLCBjb21wdHJvbGxlckltcGxDb21tYW5kcygpLCB3b3JsZCwgZXZlbnQsIGZyb20pO1xufVxuIl19